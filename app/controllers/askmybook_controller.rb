require 'rubygems'
require 'dotenv'
require 'ruby/openai'
require 'csv'
require 'cosine_similarity'

MAX_TOKENS_LENGTH = 500
SEPARATOR = "\n* "
SEPARATOR_LENGTH = 3

class AskmybookController < ApplicationController
    def index
        @book = Book.first
    end
    
    def ask_question
        @book = Book.first
        @question = Question.find_by question: params[:question]
        
        if @question.present?
            render json: { redirect: '/answer/' + @question.id.to_s }, status: :ok
            return
        else
            @question = Question.new()
            @question.question = params[:question]
            
            Dotenv.load()
            openai = OpenAI::Client.new(access_token: ENV['OPENAI_API_KEY'])
            tokenizer = Tokenizers.from_pretrained("gpt2")
            
            # Get an embedding for the question
            # question_embedding_response = openai.embeddings(
            #     parameters: {
            #         model: "text-search-curie-doc-001",
            #         input: @question.question
            #     }
            # )
            
            #question_embedding = question_embedding_response['data'][0]['embedding']
            question_embedding = [-0.013956907, -0.010338101, 0.010074229, 0.009343871, -0.030590223, 0.0058475765, -0.006478983, -0.03126875, 0.013353772, 0.00376959, -0.012863725, -0.0076758275, -0.015238567, 0.03522682, 0.011412433, 0.0013217125, -0.018772557, -0.016303476, 0.001915423, 0.00815645, -0.0058051688, -0.009423975, -0.017490897, 0.02041233, 0.015709767, 0.010922387, -0.0016821795, -0.031476077, 0.002973264, 0.015728613, 0.012694094, 0.0038449818, 0.02418192, 0.066156305, 0.018433295, 0.03831788, -0.0066910223, -0.0042290087, 0.004829787, -0.08255402, -0.027046809, -0.0070349975, -0.0104888845, -0.0002629878, 0.034774467, 0.007859595, -0.012439647, -0.026255194, 0.0043208925, -0.006135008, 0.023559937, -0.009051728, 0.012844878, -0.0032677634, 0.009617167, 0.022410212, 0.012599855, 0.013542252, 0.01994113, -0.0069831656, 0.0058522886, -0.011412433, 0.011186258, 0.0050606746, -0.042445585, 0.0026222211, -0.010394644, -0.012024992, 0.0010949482, 0.024766207, 0.0046601556, 0.007067981, -0.010950659, -0.0010914141, 0.00013377627, -0.004966435, -0.018244816, 0.0037083342, -0.0011803529, -0.005140778, -0.003333731, -0.019290878, -0.007991531, 0.008896233, -0.0012628126, 0.010008262, -0.00019436948, 0.0050512506, -0.007115101, 0.014918152, 0.021203944, -0.0010225013, 0.0038779657, 0.011742272, 0.018367328, 0.00021115594, -0.009697271, 0.03539645, -0.015493015, 0.0047261235, 0.0058994084, 0.005955952, -0.018291935, 0.005668521, -0.01898931, 0.0065826466, 0.0025044214, -0.0059182565, -0.0020414686, -0.011459554, 0.0030910638, 0.013900363, -0.040598486, 0.011186258, 0.011101442, -0.008481577, -0.011035475, -0.011789393, -0.01645426, -0.018866798, 2.2621221e-05, -0.02150551, -0.0057109287, 0.0038708977, 0.01747205, 0.035452995, -0.0043609445, 0.004514084, 0.0030533678, -0.0043161805, -0.00025459458, -0.01898931, 0.014522346, 0.0030934198, 0.003927442, 0.011327618, -0.0039227298, 0.0008617047, 0.01590767, 0.009895174, -0.0026999689, 0.028253077, 0.020732746, 0.0039227298, -0.021844774, 0.013372621, 0.010422916, -0.0027470887, 0.0064318627, -0.0050371145, -0.002634001, 0.015238567, 0.00084697973, -0.0039392216, -0.0029803321, -0.0028107006, 0.0020909444, -0.0032583394, -0.010997779, 0.018536959, -0.008118754, 0.02463427, 0.010837572, 0.010008262, -0.0016692216, 0.014541194, -0.012015568, -0.016821796, 0.016878339, 0.0051360666, 0.0011002491, 0.01567207, -0.012364255, 0.010262709, 0.008924505, -0.029006995, 0.001885973, 0.028102294, 0.0061632795, -0.00027594576, -0.023013348, 0.0019707887, -0.011421857, 0.026556762, -0.024747359, 0.022052102, 0.0023984017, -0.019064702, 0.016473109, 0.00096419046, 0.010894115, -0.01834848, 0.019177789, 0.037922077, -0.01567207, 0.0095983185, -0.002605729, 0.0051926104, -0.015624951, 0.012854302, -0.004226653, 0.0066156304, 0.021543207, 0.012552734, 0.036206912, 0.0038143538, 0.013777851, 0.0084768655, 0.016802948, 0.006271655, -0.017340114, 9.0337635e-05, 0.0035622625, 0.010988355, 0.018028064, 0.020431178, 0.028366165, -0.0009683134, -0.011026051, 0.021769382, 0.014899304, -0.004466964, 0.0070962533, -0.03624461, 0.018932765, -0.0024196056, 0.013382045, -0.027348375, 0.01880083, -0.0030910638, -0.021279335, 0.0021368864, -0.006427151, 0.033078153, 0.020770442, -0.00065261027, -0.010055381, 0.013815547, -0.007916139, 0.0024997094, -0.011827089, 0.014371562, 0.030232111, -0.0197715, 0.012317135, -0.020751594, -0.013099325, 0.0026245771, 0.007850171, -0.015549559, -0.004429268, 0.002631645, 0.009706695, 0.012741215, 0.007393108, 0.006059616, 0.022108646, 0.0017952672, -0.005729777, -0.0051219305, 0.0027329528, 0.026405977, 0.0076711155, 0.017245874, -0.004829787, 0.026632152, -0.0023724858, 0.013890939, -0.0046413075, -0.016105574, -0.020600809, -0.011223954, -0.00069207314, -0.022372516, 0.0038049298, 0.0036588584, -0.009329735, -0.008335506, 0.022240581, 0.014220778, 0.00680411, -0.0004184834, -0.0065072547, 0.0004544123, 0.014673129, 0.015370503, 0.003738962, -0.0076428438, 0.0211474, 0.017047971, -0.0057062167, -0.026726393, 0.017603986, -0.0020355787, 0.015295112, -0.010620819, -0.0013700103, -0.0152762635, 0.0010248573, -0.033492807, -0.020751594, 0.028611189, -0.008792569, -0.03413364, 0.023729568, -0.02548243, 0.00063317333, 0.004862771, 0.01567207, 0.009782086, 0.0085663935, 0.0040405295, 0.0023760197, 0.01733069, 0.0074308044, -0.014880457, -0.012354831, -0.0061915517, -0.0055789934, 0.024653118, -0.014324442, 0.0066062063, -0.016199812, -0.009989413, 0.008425034, 0.018650046, -0.09635072, 0.008071635, 0.021901319, 0.005329258, -0.0076805395, -0.0076664034, 0.007534468, 0.016030181, 0.008561681, 0.029874, 0.018668894, 0.006460135, 0.012496191, 0.008212994, -0.004862771, -0.018452143, 0.0033832071, -0.011563217, -0.000187596, 0.018320207, -0.01747205, 0.023936896, -0.0054517696, 0.017368386, -0.013146445, -0.0035387026, 0.02344685, -0.015775735, -0.0044174884, 0.006054904, -0.0028978724, -0.0020155527, -0.016746404, -0.0243704, 0.0317211, 0.0029426361, -0.019884586, -0.017047971, -0.045008905, -0.016586196, -0.01190248, -0.009857478, 0.028177686, 0.004212517, -0.0073035806, 0.019601868, -0.0048439233, 0.007157509, -0.0031900154, 0.011403009, -0.007473212, -0.001106139, 0.029892849, -0.012194623, 0.009296752, 0.011516097, 0.019375693, 0.013645916, 0.00065084326, 0.03524567, 0.0025586092, -0.0047308356, 0.015144328, 0.012477343, 0.002196964, -0.017698225, -0.008783145, 0.023182979, 0.008448593, 0.026613306, -0.020261547, 0.007063269, -0.017754769, 0.00059901143, -0.008453306, 0.009042304, 0.02906354, 0.0105737, -0.0048085833, -0.024426943, -0.02593478, -0.010008262, -0.011242802, -0.018131727, 0.0104888845, 0.006012496, -0.009447535, -0.01190248, -0.008929216, 0.008029227, 0.0034986506, -0.018621774, 0.016680436, 0.0117516965, 0.015436471, 0.0112804985, 0.025689756, -0.02022385, -0.032795433, -0.01764168, 0.0002671108, -0.008491001, -0.0073459884, 0.009433399, 0.0045941877, -0.015361079, -0.017038547, 0.009254344, -0.014512922, 0.03547184, 0.014362138, 0.028328469, 0.00081517384, -0.0005209691, -0.0056402492, 0.01941339, 0.007459076, -0.008740737, 0.005291562, 0.017208178, 0.009004608, -0.022202885, -0.002257042, 0.003427971, 0.006125584, 0.00227589, -0.009447535, -0.01865947, -0.015983062, -0.004064089, -0.036885437, -0.0069219097, 0.010460612, 0.01429617, 0.002257042, -0.012957966, 0.0021675143, 0.013928635, 0.017104514, 0.007473212, 0.010517156, -0.0039297976, -0.013834395, -0.01503124, -0.0127223665, -0.023767265, -0.026971417, 0.014569465, 0.0035999585, -0.010545428, -0.021090856, 0.010677364, 0.0077747796, -0.012109808, 0.023239523, -0.0117516965, -0.007836035, 0.001119686, 0.009263768, 0.0044575403, 0.014305594, -0.0116103375, -0.0037012661, 0.008363778, -0.0089622, -0.016944308, 0.01268467, -0.008434458, 0.0125621585, -0.015436471, -0.0021109704, -0.013928635, 0.007119813, -0.009259055, -0.009381567, 0.015295112, -0.014126538, 0.009122408, 0.018838527, 0.000753918, -0.020845832, -0.023616482, 0.008443882, -0.015841702, -0.029836304, -0.013900363, -0.015295112, 0.018640622, -0.001880083, -0.009951717, 0.0029449922, 0.0012486767, 0.02399344, -0.012345407, 0.01507836, 0.025783995, 0.015455319, 0.0017328335, -0.021750534, -0.00910356, -0.00039462897, -0.005677945, -0.024351552, 0.016275205, 0.0095983185, 0.008637073, 0.017161058, 0.010102501, 0.0060926, -0.0034939388, -0.024653118, 0.034152485, -0.007605148, 0.0019755007, -0.028931603, -0.002265288, -0.016557924, 0.0023524598, -0.01773592, 0.013598796, -0.009584183, -6.0924525e-05, -0.0069077737, 0.00093532953, 0.0008599377, 0.0016008978, -0.014720249, -0.0055837054, 0.011129715, -0.0095182145, -0.017274147, 0.0033808511, -0.0046601556, -0.0046342397, 0.007199917, 0.014230202, 0.0005954774, 0.0053716656, -0.016482532, 0.008024515, -0.00082400884, -0.044669643, -0.028328469, 0.017217603, 0.025953626, -0.013551676, -0.002702325, -0.0006561443, 0.012072112, -0.01204384, -0.0028908043, 0.008684193, -0.013872091, -0.009810358, 0.0018306072, 0.006078464, 0.036489632, -0.011167411, -0.007906715, -0.015493015, -0.0030839958, 0.0078124753, -0.0018023353, -0.018329632, -0.0077512194, 0.0039627813, -0.024351552, 0.02519971, -0.009546487, -0.014616585, 0.025576668, -0.017556865, 0.013278381, 0.006332911, 0.014145386, -0.015445895, 0.019620717, 0.0024478775, -0.009489943, 0.015926518, -0.005418786, 0.029402802, 0.011063746, 0.0018058692, -0.015408199, -0.011252226, -0.025180861, 0.009301463, 0.0044434043, 0.004613036, 0.02619865, 0.019828044, -0.0095983185, 0.004104141, 0.010234437, 0.0031876594, 0.008952776, 0.01199672, -0.00065319927, -0.020940073, -0.0014289102, -0.00827425, -0.0022016761, 0.0024313855, 0.017302418, -0.021637447, -0.0009871614, 0.0028719564, 0.0053763776, 0.003039232, -0.023654178, -0.0062245354, 0.012034416, -0.007049133, 0.007124525, 0.008641785, 0.0036517903, 0.0019201349, -0.019206062, 0.019206062, -0.02830962, 0.007892579, -0.00067028025, 0.0016927815, 0.0032960353, -0.0068276697, 0.008825553, -0.028479252, -0.0005006487, 0.00021572068, -0.029346257, 0.03522682, 0.012147504, -0.008349642, -0.0079962425, 0.037488572, 0.013589372, -0.017443778, -0.027348375, -0.0043232488, 0.016265782, 0.007840747, 0.0068323817, 0.0070255734, -9.004313e-05, 0.002288848, 0.02970437, -0.02472851, 7.826317e-05, 0.0036211624, -0.01130877, 0.004820363, -0.009763238, 0.0015408199, 0.004094717, 0.0027376649, 0.004947587, 0.0032795432, 0.031928428, -7.45083e-05, -0.005630825, -0.0070255734, -0.024031136, -0.0051784744, -0.017801888, -0.010931811, 0.01941339, -0.012477343, 0.0032088635, 0.008806705, -0.011403009, -0.011459554, 0.002629289, -0.0055083134, -0.017104514, 0.013485708, -0.009753814, -0.009570046, 0.0031923715, -0.015210296, 0.01571919, -0.010309828, 0.007181069, 0.0058475765, -0.026330587, 0.009188375, -0.01126165, 0.009098847, 0.010677364, -0.005649673, 0.008363778, 0.0036989101, -0.0120815355, -0.015587254, -0.011987296, -0.0243704, 0.02795151, 0.024351552, 0.0059606642, -0.0039038816, 0.014710825, -0.016539076, 0.0069077737, -0.009485231, -0.0059606642, -0.005743913, -0.015804006, 0.004353876, -0.02325837, 0.019526476, -0.016718132, -0.0006997301, 0.0020638504, 0.0015844058, -0.021901319, -0.025595516, 0.008745449, -0.018979887, -0.0073601245, -0.0012840166, 0.023616482, 0.009094136, -0.0049805706, 0.0012239388, -0.009061152, -0.020977769, -0.005739201, 0.011233378, -0.006083176, -0.007195205, -0.000556309, 0.0032300674, 0.00096949143, -0.0130427815, 0.0077182357, 0.013504556, 0.010008262, 0.0079962425, -0.009155392, -0.012929694, -0.0069878777, -0.004045241, -0.014230202, 0.020751594, 0.0026999689, -0.028648883, 0.02133588, -0.016557924, 0.013693036, -0.011845937, -0.007831323, -0.00687479, -0.02804575, -0.006865366, 0.0008964556, -0.006125584, 0.011779969, 0.02878082, 0.024671966, 0.0017764192, -0.0046837158, 0.0025798131, -0.022410212, 0.0033054592, -0.012694094, -0.012948542, 0.021844774, -0.0013016865, 0.0059182565, 0.005668521, -0.0032041515, 0.000748617, 0.003008604, -0.03641424, 0.0076428438, 0.019846892, 0.014918152, 0.005550721, 0.01415481, -0.0045494237, -0.009395703, 0.01751917, 0.031193357, -0.0045494237, -0.020242698, -0.011101442, 0.036338847, -0.0015467099, 0.00540465, 0.0167841, -0.031796493, -0.06280137, -0.00077512197, 0.0029308563, -0.0017740633, -0.010036534, -0.01126165, 0.0050276904, -0.007831323, 0.016897187, 0.008698329, -0.024200767, -0.02363533, 0.022334822, 0.0048392112, 0.002598661, -0.018923342, 0.0011986118, 0.0072941566, 0.015106632, -0.0019260249, -0.008783145, 0.01645426, -0.034906402, -0.011883632, 0.0108093, -0.006808822, -0.017132787, 0.0084862895, -0.0042455005, 0.028875059, 0.023955744, -0.019620717, 0.024483487, -0.0017728853, 0.008688905, 0.018923342, 0.0303452, -0.037205853, 0.00458712, -0.013108749, 0.012213471, -0.0014454022, -0.0049711466, 0.00444576, -0.010649092, 0.021731686, 0.0027117487, -0.0043114685, 0.0038214219, 0.023861505, -0.019564172, 0.0028507523, -0.0041936687, 0.00979151, 0.008641785, 0.026801785, 0.023182979, -0.018621774, -0.004938163, 0.006050192, -0.0036070265, 0.018442718, 0.02380496, 0.014333866, -0.006427151, 0.011167411, -0.010451188, -0.03669696, -0.02998709, -0.0039510014, -0.011619762, 0.015295112, 0.00066851324, 0.010309828, -0.01254331, -0.002662273, 0.021354727, 0.0076239957, 0.0042290087, -0.011638609, -0.016944308, 0.0009382745, 0.0109600825, 0.008099906, -0.012364255, -0.006017208, -0.0034798027, -0.0034161909, -0.0108093, 0.0064884066, 0.017726498, -0.00765698, -0.0053952257, -0.0008181188, -0.011638609, -0.0015796938, 0.043878026, 0.001509014, -0.0069784536, -0.009551198, -0.022504453, 0.011289922, -0.0066109183, -0.011318194, -0.0068842135, 0.017952673, 0.023126435, -0.016473109, 0.03236193, 0.0017575714, 0.011148563, -0.004464608, 0.021712838, 0.008882096, -0.009051728, -0.008637073, -0.031494923, -0.0042996886, 0.014362138, 0.009183664, -0.0078077633, 0.010234437, 0.0031853036, -0.0012628126, 0.014098266, -0.018546382, 0.027744181, 0.014654282, -0.01135589, 0.017754769, 0.015841702, 0.005597841, -0.01650138, -0.004895755, -0.010498309, -0.0004888687, 0.01351398, 0.014069995, 0.008359066, -0.0065967827, 0.0022923818, 0.011063746, 0.012910846, 0.010187317, 0.015888821, -0.010385221, -0.0024384535, 0.021034312, 0.0128731495, -0.013759003, -0.023409154, -0.008373202, 0.0037083342, -0.009923446, -0.02012961, 0.007049133, -0.0243704, 0.007270597, 0.04301102, -0.027631095, -0.0036046705, -0.009240207, -0.007251749, 0.0031216918, 0.0025515412, 0.03392631, -0.008834977, 0.004094717, -0.0062952153, 0.015323384, 0.0024172496, -0.014362138, -0.01787728, -0.0017186975, -0.015464743, 0.004938163, 0.002973264, 0.00376959, -0.011063746, -0.026179802, -0.0004499948, -0.00085051375, 0.014880457, -0.008401474, -0.007887867, 0.020393481, 0.013645916, -0.011789393, -0.002233482, -0.008387337, 0.016133845, -0.009358007, 0.012298288, 0.031362988, -0.0005636715, 0.008114043, 0.02878082, 0.016972579, -0.012364255, -0.022447908, -0.0019919928, -0.030213265, 0.00993287, -0.014079419, 0.019620717, 0.009555911, 0.006380031, -0.0035763986, 0.0059229685, -0.025331644, -0.014541194, 0.006450711, -0.010225013, 0.006271655, -0.0035363466, -0.0068276697, -0.0043703686, -0.015342231, -0.00595124, 0.0038496938, -0.0032206434, -0.023051042, 0.026217498, 0.0037036221, -0.0031334716, -0.019168366, 0.009876326, 0.021731686, -0.001506658, -0.0007863129, -0.0019436949, 0.021957861, -0.009202512, 0.0062575196, -0.016199812, 0.019319149, -0.022579843, 0.012665822, 0.010686788, 0.003364359, 0.011723425, 0.017217603, -0.011563217, -0.0023701298, 0.008731313, -0.004485812, -0.0016008978, 0.012835454, -0.0066957343, 0.029647825, 0.023032194, 0.013919211, 0.02325837, -0.017019698, 0.021279335, -0.007567452, 0.0050276904, -0.0030863518, -0.001876549, 0.024200767, 0.004148905, 0.0068370937, 0.02961013, -0.019177789, -0.012467919, 0.01784901, 0.014098266, 0.039354518, -0.015219719, 0.0032724752, 0.0003398521, -0.014004027, -0.002575101, 0.0021050805, -0.011289922, 0.007138661, 0.017717073, -0.0021628023, -0.012552734, 0.003786082, 0.018970462, 0.016265782, 0.014098266, 0.006087888, -0.0012828386, -0.019545324, -0.0038119978, -0.005140778, -0.004525864, 0.018225968, -0.015191448, -0.01571919, 0.013344348, -0.008830264, 0.00057633495, 0.008264826, 0.0027164607, -0.008057498, 0.0073601245, 0.022033254, -0.008099906, 0.010846995, 0.014258474, 0.013316076, -0.017358962, 0.00846273, -0.03909065, -0.031758796, 0.016774675, 0.0015537778, 0.01557783, -0.003927442, -0.0030580799, -0.009819782, 0.010300404, -0.016444836, -0.0009812714, 0.011487826, 0.00087466266, -0.0072187646, 0.018546382, 4.369632e-05, -0.014861609, 0.006031344, 0.0021345303, -0.012430223, -0.012430223, 0.011836513, -0.020977769, -0.012533886, 0.0058051688, 0.0155966785, -0.0007073871, -0.0069737416, -0.012335983, 0.0007221121, 0.019790348, 0.0040570213, 0.007831323, -0.0012569226, -0.018546382, -0.017556865, 0.0019484068, 0.017773617, -0.0025209133, 0.01700085, 0.0015490659, 0.020355785, 0.0007067981, -0.007572164, -0.020016523, -0.023503393, -0.021392424, 0.023465699, -0.0025963052, -0.010724484, 0.009381567, 0.015521287, 0.011930753, 0.027518006, 0.0057156407, 0.018244816, -0.0069878777, -0.009235496, 0.009499366, -0.0038968136, -0.007591012, 0.018555807, -0.0053669536, 0.007826611, -0.007105677, 0.019045854, 0.017057395, 0.0059229685, -0.027310679, 0.0004479333, -0.0065072547, -0.0030981319, -0.011233378, -0.0085663935, 0.017123362, 0.030929485, 0.01837675, 0.010413492, 0.0075863, 0.004933451, -0.016576773, 0.021298183, 0.01718933, -0.005659097, -0.022165189, 0.014446953, -0.008999896, -0.0023418579, -0.0058994084, 0.0042242967, 0.0066344785, 0.02022385, 0.0036824183, 0.03601843, -0.01043234, -0.0062999274, 0.025463581, 0.0070161493, -0.02463427, -0.013353772, 0.011544369, -0.016020758, 0.0055224495, 0.0024926413, -0.0038614736, -0.0037130462, 0.0021415984, 0.023955744, -0.026971417, 0.001504302, -0.018216543, -0.006846518, -0.026669849, -0.0040099015, 0.012053264, -0.02150551, -0.006417727, -0.025425885, -0.023691874, -0.0012109808, -0.01728357, 0.017538017, 0.004179533, -0.015427047, -0.021448968, 0.005630825, 0.011789393, -0.023597633, -0.004862771, -0.0023607058, 0.010658516, 0.011110866, -0.0077747796, 0.0009842163, -0.006474271, -0.011148563, 0.01820712, 0.015295112, -0.0061915517, -0.001863591, -0.006931334, 0.006785262, -0.003736606, 0.008118754, 0.011657457, -0.0057627605, -0.0055083134, 0.008443882, -0.017547442, -0.0027541567, 0.017726498, 0.0012098028, -0.012053264, -0.0061962637, -0.0036211624, 0.008434458, 0.0016315257, 0.011252226, -0.0070255734, 0.029308563, 0.008665345, 0.021128552, 0.026160955, -0.019045854, 0.030854095, -0.005004131, 0.0053810896, -0.0036164504, -0.036621567, -0.028271925, -0.01851811, -0.037733596, 0.0051926104, 0.010997779, -0.014833337, 0.023899201, -0.0017811313, 0.017773617, -0.01360822, -0.0029237883, -0.006540239, 0.019809196, -0.013089901, 0.031457227, -0.027555702, 0.012109808, 0.007143373, -0.019752651, 0.011195682, 0.008858536, 0.011063746, -0.0052444423, -0.010677364, 0.0057580485, -0.0028696004, -0.008132891, -0.011893056, 0.007595724, -0.007129237, 0.02143012, -0.011044899, 0.008033939, -0.012251168, 0.007553316, -0.010140197, 0.021109704, -0.03143838, -0.0028955163, 0.014635433, -0.0039015256, 0.003696554, 0.0093674315, 0.017076243, 0.03006248, 0.006064328, 0.0077747796, 0.019790348, 0.04542356, 0.0076758275, 0.019224908, -0.018470991, 0.009160103, -0.011544369, 0.0069737416, 0.013184141, 0.006342335, -0.009489943, -0.0014324442, 0.026877176, -0.0043091127, -0.01130877, 0.002643425, -0.0068842135, 0.0042549246, -0.002626933, 0.004608324, 0.008783145, 0.0017717073, 0.00458712, 0.026726393, -0.020355785, -0.016425988, 0.013721308, -0.0039769174, 0.0077370834, 0.018470991, -0.01865947, 0.0027777166, -0.0070114373, -0.014597737, 0.0031499637, 0.009485231, -0.00815645, -0.004591832, -0.0146448575, -0.011808241, -0.012156928, -0.01126165, -0.0044316244, 0.006422439, -0.013231261, -0.011205106, -0.010168469, 0.0014913441, 0.008665345, -0.0077559315, -0.014673129, 0.00038873896, 0.024690814, -0.015295112, -0.015888821, -0.009895174, 0.004153617, -0.0005898819, 0.013099325, 0.021995557, 0.020902377, 0.011252226, 0.0015902958, -0.021034312, 0.0018730151, -0.015530711, -0.019978827, -0.0061114477, 0.024332704, 0.005150202, -0.011742272, 0.013184141, 0.00082341983, 0.007869019, 0.011676305, -7.1231996e-05, -0.01865947, -0.003795506, 0.0047968035, 0.0106396675, 0.02399344, -0.018282512, -0.0006308173, -0.020336937, -0.019922283, 0.0043044006, -0.021203944, 0.0036282304, -0.049796283, 0.0031169797, -0.017029123, 0.01706682, -0.0009394525, 0.0029167202, -0.0029826881, -0.02380496, -0.007477924, 0.023239523, -0.02519971, -0.0025939492, -0.0025256253, 0.0093674315, -0.03236193, 0.001498412, -0.00059577194, 0.021675143, 0.009866902, -0.00024075311, 0.0019036429, -0.018225968, -0.006332911, -0.0013652984, 0.01692546, 4.167164e-05, 0.014626009, 0.009763238, 0.01927203, -0.0028201246, -0.014578889, 0.0114407055, -0.026556762, -0.018819679, -0.014362138, -0.0053810896, -0.0033525792, -0.0035457707, -0.005013555, -0.021373576, -0.013693036, -0.012581007, 0.03803516, -0.029006995, 0.021599751, 0.001150903, -0.0060926, 0.034623682, -0.020374633, -0.012609279, -0.007506196, 0.009848054, -0.0043703686, -0.023239523, 0.007105677, -0.008933928, 0.01913067, -0.022485605, -0.013221837, 0.006822958, 0.0042643487, -0.0015997197, -0.019469932, 0.0103192525, -0.006450711, 0.008057498, 0.014041723, 0.014955848, -0.0009041126, -0.008698329, 0.01636002, 0.0050983704, -0.010601972, -0.01227944, 0.018650046, 0.0070255734, 0.011063746, -0.0049947067, 0.01742493, -0.01723645, -0.00382849, -0.00908, -0.006073752, -0.00017802478, -0.009141256, 0.012712942, 0.017368386, -0.014512922, -0.010696212, -0.023239523, -0.0012262948, -0.012646974, -0.019978827, -0.023842657, -0.007388396, 0.0016291697, -0.0050842343, 0.007652268, -0.015040664, -0.0069737416, -0.0054941773, 0.029723218, -0.020336937, -0.006747566, -0.015182024, -0.019846892, 0.018320207, -0.008844401, -0.01683122, -0.010375797, 0.0010637311, -0.03283313, 0.00540465, -0.010074229, -0.014955848, 0.017123362, -0.0144846495, 0.0099988375, 0.019140093, -0.008957488, 0.023522241, 0.0149652725, 0.0029025844, -0.00035457706, -0.002641069, 0.012703518, 0.0073459884, -0.0062952153, -0.0054706177, -0.01816, 0.021957861, 0.0152762635, -0.002671697, -0.018150575, 0.005654385, -0.018310783, 0.0047025634, -0.008863249, 0.023239523, 0.014993545, 0.0051030824, 0.005414074, -0.012458495, -0.022560997, -0.013938059, 0.018725438, 0.0030816398, 0.017660528, 0.022052102, -0.02776303, 0.0065637985, 0.0016527296, -0.021166248, 0.023974592, -0.008015091, 0.0008104619, -0.007902003, 0.021317031, 0.008137602, 0.03211691, 0.0024949973, 0.014437529, -0.03126875, 0.004495236, -0.024163071, 0.0317211, 0.0065496624, -0.003404411, -0.039467607, 0.005343394, 0.010649092, -0.00013421802, -0.012354831, 0.019356845, -0.011205106, 0.0024078256, 0.003390275, 0.007463788, -0.01692546, 0.029195474, 0.00882084, -0.0067004464, -0.010206165, 0.0035881784, 0.03513258, 0.0006808822, -0.02555782, 0.030081328, 0.023107586, -0.02702796, 0.012364255, 0.025388189, -0.016576773, -0.0042148726, 0.006530815, -0.03236193, 0.01453177, -0.00993287, 0.0049193148, -0.0060926, 0.0069171977, -0.011459554, -0.030552527, 0.010083653, -0.0054988894, 0.007124525, 0.02133588, 0.013617644, -0.022975652, -0.014371562, 0.005414074, -0.015455319, 0.0012427866, 0.009263768, -0.031928428, -0.004905179, -0.021354727, 0.011695153, -0.0104794605, -0.061368924, -0.01254331, -0.012910846, -0.009405127, 0.0043326723, 0.013975755, -0.009876326, 0.011195682, 0.012524462, -0.004891043, 0.01415481, -0.0004906357, -0.058051687, -0.0006555553, 0.015342231, -0.0020956565, 0.03288967, -0.0020202647, -0.019394541, -0.008104619, -0.0051831864, -0.0073177167, -0.0088773845, -0.00014967922, 0.00015623184, -0.018131727, 0.032682344, -0.0015738038, 0.012222895, -0.0036541463, 0.008863249, -0.006031344, 0.0053104097, 0.009800934, -0.03108027, -0.0026245771, 0.008359066, 0.003762522, -0.018131727, 0.0070444215, 0.0043774364, 0.00853341, 0.03677235, -0.012515039, 0.0135234045, 0.0022947378, -0.02657561, -0.00085110276, 0.0038355577, 0.008844401, -0.022636387, 0.0036989101, -0.005296274, 0.018367328, -0.006785262, -0.009452247, -0.0052491543, 0.024615422, -0.017914977, 0.017594561, -0.0013900363, 0.005593129, 0.024389246, -0.012844878, -0.0034397508, 0.025350492, 0.0040428853, -0.012741215, 0.0039415774, -0.006007784, -0.00756274, -0.025048925, 0.014446953, -0.005541297, -0.024690814, 0.0016079657, 0.018932765, 0.015690919, 0.012675246, -0.004509372, 0.0067051584, -0.0034562428, -0.018913917, 0.0038567618, 0.00599836, 0.02942165, -0.0032654074, -0.0041229893, 0.0054329215, 0.0066910223, 0.00893864, 0.004829787, -0.025783995, -0.0068936376, 0.019752651, 0.008024515, 0.00042025038, -0.0104794605, 0.015002968, -0.011563217, -0.021090856, -0.013759003, -0.011789393, 0.019253181, -0.010564276, 0.022862563, 0.01870659, 0.0020414686, 0.0047426154, 0.013768427, -0.0051831864, 0.017198754, 0.0074873483, 0.017179906, -0.017085666, -0.0028389725, -5.61021e-05, 0.0034750907, -0.0021203943, 0.023899201, -0.019281453, 0.010554852, -0.002671697, 0.010309828, 0.010300404, -0.0007232901, 0.0064412868, 0.009240207, 0.019356845, 0.010507732, -0.030967182, 0.029082388, -0.001088469, 0.001102605, 0.0016692216, -0.003378495, 0.020374633, -0.030420592, -0.009645439, 0.010564276, -0.005597841, 0.005993648, 0.009621878, 0.020110762, 0.019121245, -0.017726498, 0.0367535, -0.007181069, 0.004886331, -0.014899304, -0.0049711466, -0.0141642345, 0.0012286507, -0.005743913, -0.008198858, 0.013419741, -0.0024219616, -0.0050983704, -0.006398879, 0.0066344785, -0.035811104, -0.0078124753, 0.006445999, 0.0139946025, -0.0012616346, -0.050210938, 0.0012533887, -0.00455178, -0.009240207, 0.0017740633, 0.0029544162, 0.011695153, 0.0065873587, 0.0032182874, 0.0030580799, -0.0072753085, -0.0009965854, 0.0151726, -0.0062575196, -0.002666985, 0.018734863, -0.005739201, 0.007063269, -0.00090941356, -0.005550721, -0.011629185, 0.010441764, -0.0070821173, 0.000741549, 0.0072988686, -0.009329735, 0.0031711676, 0.014880457, 0.002662273, 0.018621774, -0.00051861315, -0.0077276593, -0.004754395, 0.011393586, 0.0032489153, -0.0034138348, 0.009546487, -0.0073459884, 0.005677945, -0.011242802, -0.0007079761, 0.0021545563, 0.0088868085, 0.0108093, 0.016916035, 0.023748416, 0.002271178, 0.009108271, 0.00988575, -0.0032748312, 0.0012062688, 0.00019186625, 0.028064597, 0.027103351, 0.01700085, -0.016567348, 0.01185536, 0.0061962637, 0.010300404, 0.0007062091, -0.012675246, -0.012807182, -0.011723425, 0.0032512713, -0.055789933, 0.0051737623, 0.0096878465, 0.021467814, -0.012731791, -0.0007126881, -0.011770545, -0.027386071, -0.0028931603, -0.005546009, -0.008439169, 0.008481577, 0.0012310067, -0.0066344785, -0.012646974, 0.014833337, -0.007265885, -0.022033254, 0.0014783861, 0.017980944, -0.009800934, 0.0025892372, -0.00687479, 0.004905179, 0.024351552, 0.017029123, -0.0061067357, -0.0006449533, 0.00685123, 0.014578889, -0.0073695485, 0.017575713, -0.0027777166, -0.024389246, 0.008439169, -0.005140778, -0.009164816, 0.0065119667, -0.008288386, -0.002996824, 0.006474271, -0.0053763776, -0.019639565, 0.003802574, -0.0013782564, 0.017113939, 0.019790348, 0.0015679138, -0.008990472, -0.010752755, -0.004485812, 0.006413015, 0.009390991, 0.012703518, -0.012204047, -0.016322324, 0.019828044, 0.0104794605, 0.02932741, 0.024332704, -0.019337997, -0.0007857239, 0.0064931186, -0.011157987, 0.0046625114, -0.02721644, -0.0012180487, 1.03903e-05, -0.024973534, -0.00021410093, -0.009541775, 0.0303452, -0.0035174987, 0.013400893, 0.009617167, 0.0052397302, -0.013824971, -0.0020426465, -0.019677259, -0.0076664034, 0.01816, -0.004867483, -0.0024620134, -0.033097, 0.028328469, 0.003390275, -0.009668998, -0.0068418058, -0.017368386, 0.010422916, -0.0054423455, -0.008674769, -0.014560041, -0.0088868085, -0.01071506, 0.0012651687, 0.00458712, -0.0013099326, -0.025237406, 0.022787172, -0.017905552, -0.013589372, 0.044782728, 0.017905552, -0.0027423766, -0.010111925, -0.024125377, 0.018621774, 0.022202885, -0.020073067, -0.038638297, 0.0062056873, -0.010102501, -0.03539645, 0.005611977, -0.00965015, 0.029572433, -0.031777643, 0.00070385315, 0.0041229893, 0.0032677634, 0.008750161, -0.028648883, -0.010592548, 0.0147956405, -0.020958921, 0.0004523508, -0.024653118, 0.0036565023, -0.014522346, 0.011016627, 0.0057721846, 0.014833337, 0.0031900154, 0.025501275, 0.00017419629, 0.0072234767, -0.008217706, -0.018470991, -0.0028625324, 0.008434458, -0.0061727036, -0.0033407991, -0.014918152, 0.0062857913, 0.0061821276, 0.017161058, 0.013287805, 0.006799398, 0.010733907, 0.0050276904, 0.017415505, 0.017443778, 0.0043703686, -0.015163176, 0.005626113, 0.022806019, 0.00083284377, -0.009348583, 0.0027894967, -0.008401474, -0.012458495, 0.018810254, 0.0004511728, -0.025388189, 0.0023748416, 0.0358488, 0.0062339595, 0.0152856875, -0.012571583, 0.010008262, -0.0017622833, 0.0045494237, -0.011176834, -0.008104619, 0.017010275, 0.0096784225, -4.8518745e-05, 0.013372621, 0.007949123, -0.0020603165, -0.0027965645, -0.00059960043, -0.01263755, 0.001520794, -0.004858059, 0.041616272, -0.00018023352, -0.002572745, 0.005984224, -0.0009771484, -0.007605148, -0.0024926413, 0.019677259, 0.009004608, -0.006526103, -0.010903539, 0.0065543745, 0.023654178, 0.03686659, 0.013400893, -0.005225594, 0.03613152, -0.02207095, -0.05533758, 0.0012922626, 0.008750161, 0.0040028333, -0.011666881, -0.0012934406, -0.003738962, -0.0024737935, -0.003736606, -0.013740156, -0.0036800622, -0.0013700103, -0.005955952, 0.01728357, -0.018876221, -0.019790348, -0.0072329007, 0.00036989103, 0.018678319, 0.007902003, 0.008613513, 0.006846518, 0.016746404, -0.0026952568, -0.02041233, 0.030420592, -0.040033046, -0.0211474, -0.01453177, -0.015182024, 0.0016703996, 0.0057674726, 0.014277322, 0.043991115, -0.00038991697, 0.0035999585, -0.015992485, -0.0025963052, 0.022165189, -0.014315018, -0.009584183, 0.0077370834, -0.02022385, 0.023277218, -0.023842657, -0.00087525166, -0.00044233783, 0.020940073, -0.016812371, -0.015992485, -0.003329019, 9.2031005e-05, -0.0025680333, 0.008528697, 0.016331749, 0.009485231, -0.0018364971, 0.025953626, 0.003788438, -0.0021840062, -0.00080751686, -0.0024690814, 0.010366373, 0.0037436741, -0.008128178, 0.022598691, -0.026255194, 0.0017752413, 0.02188247, 0.0074685, 0.025030078, -0.0008351998, -0.018103456, 0.037375484, 0.004834499, -0.0043703686, -0.00020497145, 0.0031523197, 0.005230306, -0.0018447432, 0.0012957966, 0.0058428645, 0.0061020236, 0.009725542, -0.013966331, 0.007869019, 0.031645708, -0.0074826363, 0.010743331, -0.016416565, 0.008910368, 0.010922387, -0.0036635704, -0.0034538868, -0.014446953, 0.023578785, 0.008750161, -0.005150202, 0.0077182357, 0.0076711155, 0.018480415, -0.0078030513, 0.0070302854, 0.007214053, 0.00096477946, 0.018386176, 0.02629289, -0.01842387, 0.027254136, -0.0039698496, 0.021015463, -0.014315018, -0.009546487, 0.014173659, 0.020468874, -0.012844878, -0.02951589, 0.020186154, 0.014183083, 0.02012961, 0.0025279813, 0.0012227608, -0.0144846495, 0.009051728, -0.017622834, 0.010620819, 0.015794583, -0.01424905, -0.025331644, -0.009725542, -0.02391805, -0.015257415, 0.021543207, 0.0073177167, 0.015304536, -0.008184723, 0.030194417, 0.015200872, -0.026971417, 0.018235391, -0.02418192, 0.0017363674, 0.031683404, -0.0014265542, 0.015502439, -0.0040970733, 0.002212278, -0.0027353088, 0.0021569123, -0.022787172, -0.0031805916, -0.02041233, 0.0072894446, 0.033040456, -0.009668998, -0.0061821276, 0.0054659056, 0.010762179, 0.015370503, -0.0029332123, 0.0059700883, 0.016991427, 0.00039992994, 0.013777851, -0.01747205, -0.016246933, 0.01965841, -0.021203944, -0.0025256253, 0.0092873275, -0.022466756, -0.003062792, -0.011582065, 0.004542356, 0.01002711, -0.007572164, 0.0035858224, -0.014541194, -0.0014006383, -0.0006319953, -0.0119213285, -0.003830846, -0.02069505, -0.010036534, 0.02702796, 0.0043138247, -0.0061020236, -0.013787275, 0.010941235, -0.0051690503, -0.011252226, -0.019978827, -0.005748625, -0.014220778, 0.00016168007, 0.024596576, 0.003001536, -0.0027470887, 0.006337623, -0.013429164, -0.012326559, -0.0042407885, -0.0017151635, 0.0023312557, -0.01213808, -0.005277426, 0.0018258952, 0.0096784225, 0.0038708977, 0.0042242967, -0.022240581, 0.012581007, 0.0070821173, 0.0049711466, 0.021920165, 0.008019803, 0.033907462, 0.014814489, -0.0044528283, 0.017773617, -0.013259533, 0.008189434, -0.0065685106, -0.01898931, -0.017801888, 0.00886796, 0.003027452, 0.01773592, 0.025991322, 0.009753814, -0.004236077, 0.015935943, -0.011619762, -0.0020367566, 0.019620717, 0.013448012, 0.013862668, -0.016934883, 0.008811417, -0.0047261235, 0.0025020654, -0.008453306, -0.0033266633, 0.0023182977, 0.0016185677, -0.010658516, 0.0077088117, 0.014060571, 0.016774675, -0.013693036, 0.018781982, -0.010517156, -0.013071054, 0.027536854, 0.033153545, -0.03392631, 0.025595516, -0.015304536, 0.015540135, -0.025802843, 0.00993287, 0.006384743, 0.00036989103, -0.000753329, -0.015841702, -0.003795506, -0.012552734, 0.028743124, -0.0006043124, 0.002291204, -0.009230783, 0.009178951, -0.013768427, -0.0068418058, -0.0027682926, 0.0058758482, -0.027687639, 0.00825069, 0.0047379034, -0.00035722755, -0.0037130462, -0.003394987, -0.010884691, 0.017764192, 0.005932392, 0.014145386, -0.0062575196, 0.0086464975, -0.02548243, -0.010988355, 0.0077606435, -0.016303476, 0.027631095, 0.0070915413, 0.0052444423, -0.013495132, -0.01282603, -0.011987296, -0.017575713, 0.018621774, -0.018555807, -0.02536934, 0.010460612, -0.005206746, -0.030194417, -0.022730628, -0.019394541, 0.016020758, 0.007991531, 0.018838527, -0.006408303, 0.0061208718, 0.011195682, -0.019997675, 0.0013099326, -0.026104411, -0.012863725, 0.01825424, 0.012317135, -0.0047920914, -0.0030510118, 0.002678765, 0.011374738, 0.002242906, 0.010818724, -0.018555807, 0.0086464975, -0.012957966, -0.0054470575, -0.002643425, 0.01531396, 0.009381567, -0.028196532, -0.0036894863, 0.0011868319, -0.012486767, -0.01571919, -0.008811417, -0.019469932, 0.013730732, 0.020336937, -0.016529651, -0.007077405, 0.004429268, -0.0020579605, 0.004120633, 0.010206165, 0.008019803, 0.0069878777, -0.038393274, -0.014409258, 0.008703041, 0.0026222211, -0.0006314063, -0.051718775, -0.035189122, 0.00528685, -0.0028955163, 0.012204047, -0.02408768, -0.0014206643, -0.01360822, -0.008754873, -0.0014795641, 0.011883632, -0.009504079, 0.015775735, 0.007265885, -0.006865366, -0.0049899947, 0.0068323817, 0.009753814, -0.009555911, 0.011478402, -0.00829781, -0.011544369, -0.035716865, -0.0116009135, -0.031570315, -0.015653223, 0.005946528, -0.028234228, -0.017358962, -0.010460612, -0.0007003191, -0.007576876, -0.0008999896, -0.030533679, 0.0029049404, 0.0040122573, -0.025802843, 0.021844774, -0.026424825, 0.0011962558, 0.009485231, -0.004137125, 0.0058946963, 0.0073695485, 0.019733803, 0.0008363778, -0.0033054592, 0.018235391, -0.004130057, 0.0061821276, -0.0050936583, -0.02380496, -0.019074125, 0.0016020758, 0.0038779657, 0.0024596574, -0.02143012, 0.0077512194, -0.033587046, 0.0125621585, 0.013080478, -0.010733907, -0.0165485, 0.0001130877, 0.013306653, -0.015323384, -0.0058570006, -0.0035222108, 0.004565916, 0.0024502336, 0.0010637311, 0.012910846, 0.0068323817, 0.008825553, -0.01135589, -0.02572745, -0.01277891, 0.0021003685, -0.011553793, 0.03652733, -0.008114043, -0.0039392216, -0.010564276, -0.0048486353, -0.009339159, -0.030119024, 0.025802843, -0.0039557135, -0.0019319148, -0.012581007, 0.009047016, 0.009409839, -0.00027594576, -0.002192252, 0.016633315, 0.010545428, 0.0032818993, 0.0062480955, 0.021637447, 0.0009747924, 0.030081328, 0.016916035, 0.014069995, 0.005154914, 0.0013570524, -0.025783995, -0.0065779346, 0.011506674, 0.008019803, 0.0069030616, -0.010762179, 0.028403861, 0.010875267, -0.0061114477, 0.006036056, -0.01889507, -0.026029019, 0.029308563, -0.015832279, -0.013627068, 0.009697271, 0.012939118, 0.009292039, -0.0076098596, 0.003767234, 0.0029072962, -0.004794447, 0.052058037, -0.014173659, 0.020186154, 0.013881515, -0.0051266425, -0.011374738, 0.026274042, 0.03385092, -0.011487826, -0.0018494551, -0.018037489, -0.023654178, 0.007204629, 0.004499948, 0.011714001, 0.0021993201, 0.012411375, -0.008561681, -0.0019224909, 0.004834499, 0.0004832732, -0.029892849, 0.012166352, -0.017434353, 0.02344685, 0.0012033238, 0.013438588, -0.0216186, 0.017434353, -0.011836513, -0.0004868072, 0.026462521, 0.0023830878, -0.0058805603, -0.018169424, -0.0059700883, -0.018829102, -0.0035763986, 0.0020980125, -0.011082594, 0.0061020236, 0.016972579, 0.0012251168, 0.007181069, -0.008066922, 0.0013605864, 0.008594665, 0.0096784225, 0.012204047, -0.0028177686, 0.008721889, 0.030609071, 0.00979151, 0.0035881784, -0.008919792, 0.0042195846, 0.0043915724, -0.010903539, -0.016416565, -0.028121142, 0.031645708, 0.015926518, 0.0013063985, -0.0057015046, -0.019526476, 0.031023726, 0.034416355, 0.0011762299, -0.021317031, 0.0019872808, 0.012599855, 0.0023371459, 0.0003006837, 0.004509372, -0.0035104307, 0.029044691, 0.013155869, -0.0044269124, 0.027084503, 0.029591281, 0.019356845, -0.012844878, -0.0025326933, 0.002603373, -0.0006290503, 0.0014713181, 0.008995184, 0.0070349975, -0.0023654178, -0.00462246, 0.0038167099, 0.00458712, 0.009178951, 0.009433399, -0.025501275, 0.018461566, 0.0021062584, 0.0054564816, 0.004525864, -0.006427151, 0.009819782, 0.0006449533, 0.0062433835, -0.002254686, -0.024200767, -0.0014324442, -0.038939863, 0.009329735, 0.008048074, 0.006794686, -0.017773617, -0.013928635, 0.005268002, -0.01586055, -0.016982002, 0.012222895, -0.0024313855, -0.018772557, -0.014324442, -0.020261547, 0.019281453, -0.002662273, -0.031174509, -0.02225943, 0.012270016, 0.005352818, -0.018970462, 0.023578785, 0.011176834, -0.00057368446, -0.023842657, -0.0070397095, 0.016171541, 0.009668998, 0.0062245354, -0.0024007577, 0.006012496, 0.005362242, 0.0017893773, -0.010865843, -0.003329019, 0.006870078, -0.015144328, 0.008839688, -0.018131727, 0.00149959, -0.0030957758, 0.0067004464, 0.012863725, 0.0040146136, -0.017792465, 0.009023456, 0.0012793046, -0.014201931, 0.00025739233, 0.0032065075, 0.02290026, 0.00229356, -0.009193088, 0.014352714, -0.009560622, -0.007548604, -0.01683122, 0.009725542, 0.0028696004, 0.023673026, -0.013627068, 0.013664763, 0.0077040996, 0.0147956405, -0.0836849, -0.016124422, 0.0051219305, -0.0061727036, -0.0047473274, 0.020468874, 0.0038685417, 0.027348375, 0.010422916, -0.017047971, 0.0006797042, -0.0025350493, 0.026462521, -0.0029520602, 0.019526476, 0.0009235495, 0.036828894, 0.012166352, 0.024841597, 0.010507732, 0.0062151114, -0.020148458, 0.0160773, 0.014352714, 0.035321057, -0.006728718, -0.028630037, 0.010705636, -0.009094136, -0.005140778, -0.017990367, -0.011987296, 0.05017324, -0.02050657, -0.0014029943, 0.005258578, 0.025915932, 0.01927203, 0.0073412764, 0.007449652, -0.007256461, -0.0068370937, -0.0151160555, -0.022919107, 0.00018803775, 0.024992382, 0.005729777, 0.023503393, 0.048137665, -0.0059795124, 0.0121852, -0.0015525998, -0.0046719355, -0.00065791124, -0.014955848, 0.010922387, -0.007887867, 0.009169527, -0.02188247, -0.22331052, 0.007591012, 0.011893056, 0.022052102, -0.0049146027, 0.011242802, 0.005211458, -0.017651105, -0.013740156, -0.008151738, 0.012760062, -0.0010554852, 0.0010236793, -0.0018211831, 0.01700085, 0.018593503, 0.008368489, 0.026990265, -0.015615527, 0.006672174, -0.0011997898, 0.02058196, 0.027103351, 0.006054904, -0.0032654074, 0.012712942, -0.0012262948, -0.0031499637, -0.02105316, -0.00029199597, 0.002681121, -0.024389246, -0.021354727, -0.020110762, 0.030269807, -0.012939118, -0.006469559, -0.0014607161, 0.01645426, 0.021524359, 0.007157509, 0.011167411, -0.012298288, 0.00019495848, 0.01254331, -0.008425034, 0.00032336015, -0.011582065, -0.019526476, 0.012788334, -0.024389246, 0.0010513623, -0.007906715, 0.0039792736, 0.0124019515, -0.02105316, -0.01948878, -0.0038897456, 0.018216543, 0.02290026, 0.007840747, 0.0014194862, 0.0117516965, -0.00514549, 0.004210161, -0.011864784, -0.019111821, -0.016633315, 0.00029346847, 0.008043363, 0.022843715, 0.00059459393, 0.009141256, -0.032701194, -0.011421857, 0.012609279, 0.004905179, -0.005871136, 0.0036258744, 0.02005422, -0.020732746, 0.01948878, 0.0020614946, -0.0021993201, 0.0027470887, -0.020336937, -0.0030533678, 0.02041233, 0.023277218, -0.013174717, 0.005654385, -0.0023819096, -0.016011333, 0.007543892, -0.011666881, 0.006460135, -0.024295008, 0.0065685106, -0.006926622, 0.007543892, -0.013344348, -0.0038708977, -0.020167306, -0.013174717, -0.0064412868, 0.008194147, 0.0020614946, 0.02225943, 0.010422916, 0.008090482, 0.016322324, -0.008726601, 0.0046648677, 0.019903434, 0.008335506, -0.009716118, 0.0096878465, 0.0186312, 0.013306653, 0.015587254, -0.00088762067, -0.022749476, 0.012496191, 0.011845937, 0.006818246, 0.061368924, 0.004073513, -0.021260487, 0.008769008, -0.0078124753, -0.018904494, -0.0031900154, -0.01834848, -0.020676201, 0.004217229, -0.011685729, -0.011629185, 0.0042290087, -0.01751917, 0.0099988375, -0.019027006, 0.015822854, 0.0058475765, -0.015219719, 0.01213808, 0.022353668, 0.0027188167, -0.04523508, -0.023314914, 0.0013440944, 0.020996617, -0.023691874, 0.006813534, -0.014616585, -0.017321266, -0.0041889567, -0.026349435, -0.014465801, 0.002326544, 0.0020167306, 0.011968448, -0.006328199, 0.02501123, -0.006078464, 0.0036894863, 0.011016627, 0.032399625, -0.009753814, 0.00038844446, -0.0058428645, -0.012599855, 0.013005085, 0.0009129476, 0.021015463, -0.016105574, 0.03961839, -0.008915081, -0.007529756, -0.004942875, 0.00903288, 0.00070208614, 0.012439647, -0.0017481473, 0.019601868, -0.015926518, -0.033021607, 0.01581343, 0.009226072, 0.019601868, 0.032531563, -0.0116103375, 0.0057203528, -0.024483487, -0.026990265, 0.0031640995, 0.017208178, -0.027065657, -0.0016880695, 0.0039156615, -0.0020944783, 0.01747205, -0.005588417, 0.0021345303, -0.010856419, 0.017801888, -0.0077088117, -0.014786216, 0.00675699, 0.0047402596, 0.0073695485, 0.005692081, -0.0019613649, 0.018763134, -0.015295112, 0.002603373, -0.006672174, 0.004094717, -0.0092779035, 0.0008605267, -0.0004918137, 0.0025821691, -0.0017846653, 0.029497042, -0.018819679, 0.005150202, -0.01816, -0.006266943, -0.004115921, -0.0041229893, -0.004226653, 0.015587254, -0.022806019, 0.0011002491, 0.017811313, -0.009970565, -0.012731791, 0.033794373, -0.013928635, -0.015351655, 0.003762522, -0.026537914, 0.031231053, 0.0021463104, 0.0025892372, -0.017528594, 0.023823809, -0.0054282094, -0.015436471, 7.1646136e-06, -0.00066733523, 0.001139123, -0.008382626, 0.045951303, -0.0031617435, 0.016294053, -0.03273889, 0.011893056, 0.004441048, -0.019601868, 0.0243704, -0.0027942085, 0.0116103375, -0.008071635, 0.0020567826, -0.009193088, 0.02951589, -0.017085666, -0.013316076, 0.0011615049, -0.017029123, -0.018263664, 0.006474271, -0.006789974, -0.0054847533, 0.01121453, -0.008538121, 0.018197695, -0.016397716, 0.029855153, -0.009489943, 0.010950659, 0.017010275, -0.029346257, -0.020996617, 0.008849112, -0.02795151, -0.01851811, 0.01621866, 0.019469932, -0.0043962845, -0.004794447, -0.019356845, 0.0069219097, 0.00687479, -0.017726498, 0.016605044, -0.0091977995, 0.0073554125, -0.00979151, -0.0027494447, 0.007605148, -0.038412124, 0.0029237883, -0.03290852, -0.0197715, 0.008726601, 0.0066344785, -0.011393586, 0.023503393, -0.0009842163, 0.013174717, -0.0015961857, 0.0053952257, 0.004163041, 0.00905644, 0.016605044, -0.020845832, -0.0032583394, 0.017801888, -0.011176834, 0.014833337, -0.006394167, 0.012213471, 0.012590431, -0.012948542, 0.0012416088, 0.0007062091, -0.018791405, -0.014041723, -0.019696107, 0.014616585, 0.012609279, 0.016567348, 0.026669849, -0.01683122, -0.0035387026, 0.021241639, -0.0010395822, 0.025595516, 0.0013841463, 0.002650493, -0.0073742606, 0.026029019, 0.012467919, 0.008326082, 0.007836035, -0.012891998, 0.023428002, 0.015163176, 0.0055177375, 0.006087888, -0.0025374054, 0.03402055, -7.0569375e-05, 0.005004131, -0.0063093514, 0.0050795227, 0.013570524, 0.019620717, -0.02325837, -0.0011585599, -0.014833337, -0.042822544, -0.006059616, -0.008208282, -0.008853825, 0.016774675, 0.016934883, 0.0066910223, -0.00675699, -0.006474271, -0.023880353, -0.028818516, 0.019620717, -0.0112804985, -0.009570046, -0.00950879, 0.016067877, -0.003333731, 0.007162221, 0.006036056, 0.013334924, 0.015247991, 0.011817665, 0.017745346, -0.007199917, 0.0046554436, -0.006050192, -0.01439041, -0.008066922, 0.0020414686, -0.009810358, -0.0155966785, 0.011252226, 0.009193088, 0.02418192, 0.008990472, -0.012109808, -0.003406767, 0.008175299, -0.002575101, -0.015851125, 0.001512548, 0.012194623, -0.00072976906, -0.0061774156, -0.0077040996, 0.0031923715, -0.004174821, -0.0054282094, 0.010696212, -0.008712465, -0.0004873962, 0.0013075765, 0.018923342, -0.01659562, -0.008589953, 0.002267644, 0.00675699, 0.013796699, 7.0569375e-05, -0.014842761, -0.0072329007, 0.0053716656, 0.0077276593, -0.007991531, 0.0016892476, -0.021957861, 0.011384162, 0.011911904, -0.011167411, 0.019281453, 0.007388396, -0.019375693, 0.0065590865, -0.017660528, -0.0012663467, -0.0179244, -0.016341172, 0.019733803, 0.04568743, 0.017104514, 0.010950659, 0.022504453, 0.0211474, -0.0061774156, -0.0147956405, 0.008062211, -0.021298183, 0.006535527, -0.020431178, 0.015690919, -0.025915932, 0.0035410586, -0.023333762, 0.005268002, -0.0011715179, -0.023786113, 0.013448012, 0.015106632, -0.013542252, 0.026971417, 0.008189434, -0.0010725661, 0.006398879, -0.02868658, 0.017603986, 0.009423975, 0.008999896, 0.006483695, 0.0146448575, -0.005004131, -0.014993545, 0.004905179, 0.015398775, -0.013532829, -0.008872673, -0.0007003191, -0.011591489, 0.001119686, 0.014239626, -0.005993648, -0.008618225, -0.018951613, 0.025331644, -0.003736606, 0.0044386922, -0.0035976025, 0.016963154, -0.02472851, 0.011468978, 0.015945366, -0.0083166575, 0.0065920707, 0.016878339, -0.0043044006, 0.0038167099, -0.01135589, -0.0066014943, 0.017453201, -0.0038049298, -0.0051596262, 0.009716118, 0.025972474, -0.01773592, 0.020958921, -0.0167841, 0.023145283, -0.0013122886, -0.008208282, 0.03456714, 0.011779969, 0.005324546, 0.01889507, -0.014710825, -0.00043144135, 0.021901319, -0.0008634717, 0.006992589, 0.0008375558, 0.006870078, -0.005268002, 0.036565024, 0.002176938, -0.019696107, 0.0252751, -0.0065967827, -0.011817665, 0.013014509, 0.007124525, -0.016378868, 0.00853341, -0.009607743, -0.0008192968, -0.006775838, 0.015747461, -0.0065920707, 0.012251168, -0.0039038816, -0.021279335, 0.017481474, -0.010045958, 0.029157778, -0.015502439, -0.018244816, -0.0117611205, 0.0005695615, 0.0046201036, -0.00032070966, -0.015738038, -0.009075288, 0.002973264, -0.0050559626, -0.004881619, 0.016331749, 0.00066026725, -0.016152693, 0.020280395, -0.036489632, -0.00834493, 0.0068323817, -0.018668894, 0.013080478, -0.01773592, 0.027367223, -0.026085563, -0.013551676, 0.0049758586, 0.0050889463, -0.011563217, -0.0040216814, 0.0114407055, 0.02766879, -0.011516097, 0.030741006, -0.02058196, -0.02214634, -0.012939118, 0.017076243, -0.011695153, -0.0046790037, -0.020355785, -0.005673233, 0.03183419, -0.013202989, -0.019168366, -0.0047331913, 0.00825069, -0.00839205, 0.01650138, 0.0077747796, -0.013155869, -0.013711884, 0.014399834, -0.0080857705, 0.01121453, -0.013862668, 0.005729777, 0.014126538, 0.0036753502, -0.018084608, 0.016397716, 0.00993287, -0.013457436, 0.017980944, 0.012034416, -0.017029123, 0.016680436, 0.0063140634, -0.0047732433, 0.019432236, 0.0032394915, 0.003696554, 0.020826984, 0.015822854, 0.010677364, -0.025048925, -0.020374633, -0.008198858, 0.008443882, 0.0063658953, -0.021467814, 0.026594458, 0.0030863518, -0.008684193, 0.010074229, 0.00882084, 0.011582065, -0.0025374054, 0.0070821173, 0.010045958, -0.0057957447, -0.0076946756, 0.024012288, -0.003369071, 0.014069995, 0.020770442, 0.0076192836, 0.0062292474, -0.016982002, -0.0017316554, 0.0111202905, 0.0009058796, 0.003826134, 0.02418192, -0.017933825, -0.0020532485, -0.0054659056, -0.015050088, 0.0023489257, 0.014022875, -7.2115494e-05, 0.009848054, -0.010705636, 0.01778304, -0.015643798, 0.0034562428, 0.0077040996, -0.004806227, -0.018037489, 0.021185096, -0.00048003372, -0.019337997, 0.004537644, -0.0016692216, 0.0050418265, -0.0062292474, -0.008373202, -0.0020909444, -0.0042902646, -0.0040146136, -0.0020779865, 0.003797862, 0.016397716, -0.011516097, -0.0074166683, -0.0146448575, -0.018640622, 0.010338101, -0.004961723, 0.0016456617, -0.010997779, 0.001900109, -0.0027942085, 0.005220882, 0.0005872314, -0.020676201, 0.0058899843, 0.0054329215, -0.021448968, 0.0009482875, -0.014041723, 0.020676201, 0.0031028436, 0.002232304, 0.022466756, -0.001154437, 0.013947483, -0.014371562, -0.014305594, -0.004137125, -0.02721644, 0.011525521, -0.0031193357, -0.014767369, -0.008019803, 0.027442615, 0.007581588, 0.002192252, -0.01761341, -0.02290026, 0.0029143642, 0.035452995, 0.017161058, -0.0032748312, -0.012515039, 0.009028168, 0.0062339595, 0.0034750907, 0.0049758586, 0.021279335, 0.0016491957, 0.0072753085, 0.018452143, 0.0043138247, 0.0035033626, -0.015530711, -0.0009058796, 0.0065543745, -0.009263768, -0.009923446, -0.0043256045, -0.00059312145, -0.007181069, 0.009207224, 0.023880353, 0.0047520394, 0.00016418331, -0.01190248, 0.0042737727, -0.01948878, 0.0035834664, -0.019215485, -0.030495983, -0.004205449, -0.034906402, 0.003465667, -0.00031334718, 0.0062386715, -0.0057674726, -0.012317135, -0.010140197, -0.01764168, 0.019394541, 0.015643798, -0.006676886, -0.029157778, -0.00028448625, 0.008208282, -0.030552527, -0.0069030616, -0.018499263, 0.0036352985, 0.0025421171, -0.027348375, -0.006266943, -0.011252226, -0.0024219616, -0.004858059, 0.0029237883, -0.01756629, 0.016652163, 0.0024455215, 0.0020237986, 0.012769486, 0.016557924, 0.015841702, -0.016096149, 0.00449288, 0.01986574, 0.0011685729, 0.018951613, -0.0040923613, -0.004525864, -0.005235018, -0.019564172, -0.0011597379, -0.00666275, 0.0069596055, 0.0009565335, 0.0010454722, -0.02225943, 0.0054800413, 0.013938059, -0.001890685, -0.016425988, -0.012844878, 0.01856523, 0.001140301, -0.0073035806, 0.014701401, 0.009405127, -0.011770545, 0.012317135, 0.0076145716, -4.3880384e-05, -0.0065967827, 0.013108749, 0.002631645, -0.0083967615, 0.0077229473, -0.0038991696, -0.01941339, -0.0066533266, -0.0098386295, -0.0028908043, 0.009645439, 0.009131832, -0.013089901, -0.0042290087, -0.0018011573, 0.010394644, -0.0096784225, 0.008052787, 0.009226072, -0.018640622, 0.021486662, -0.04580052, -0.021203944, 0.019469932, 0.0012993305, -0.009772662, 0.008849112, 0.016162118, -0.00055572, -0.041314706, 0.012458495, 0.011732849, 0.017773617, 0.02648137, 0.033511654, -0.0050748107, -0.004523508, -0.021769382, 0.026255194, 0.0070349975, 0.02427616, -0.023314914, 0.00054335105, -0.02629289, -0.0035858224, 0.008359066, 0.006403591, 0.0020131967, -0.0050889463, -0.0011726959, 0.0096784225, -0.015210296, -0.003385563, 0.0050700987, 0.018979887, 0.0032842553, 0.012439647, 0.008057498, -0.008260114, 0.0092779035, 0.0010030643, 0.018923342, 0.009480519, 0.01429617, -0.016275205, 0.036470782, 0.02169399, -0.014974697, -0.0018506331, 0.022579843, -0.022749476, 0.022956803, -0.0031287598, 0.0127223665, -0.024068832, 0.020450026, -0.0057674726, -0.014305594, 0.0027894967, 0.008995184, -0.016765252, -0.003331375, 0.002601017, 0.037903227, -0.0013181785, -0.02133588, 0.012015568, 0.002253508, 0.005004131, 0.02335261, -0.007939699, -0.008354354, -0.015728613, 0.024671966, 0.014088843, -0.010884691, -0.0009665464, 0.0015926518, -0.007459076, -0.0028908043, -0.0065920707, 0.00010344285, 0.0012274728, -0.02584054, 0.02150551, -0.024540031, -0.008684193, 0.0043397406, 0.0012734146, -0.00042908537, -0.017340114, -0.026688697, 0.011591489, 0.0135611, 0.014437529, 0.0025562532, -0.00526329, 0.017010275, 0.006855942, -0.0012616346, 0.024049984, -0.013579948, 0.0039627813, -0.00832137, 0.012599855, 0.011845937, 0.012552734, 0.0027588687, 0.0119213285, -0.0077465074, 0.0072329007, -0.009131832, 0.015756886, 0.0072234767, -0.006450711, 0.0059606642, 0.03430327, -0.0019083549, -0.0028483965, 0.043878026, -0.009499366, 0.032682344, -0.0065826466, -0.00033337311, -0.008552257, -0.014927576, -0.020091916, -0.007110389, 0.022447908, 0.0062198234, -0.012731791, 0.013023933, -0.00082459784, 0.024200767, -0.0024525896, -0.009193088, 0.012147504, -0.019526476, 0.0073789726, -0.012910846, 0.015436471, -0.017594561, -0.002643425, -0.017085666, -0.02050657, 0.018197695, 0.0078454595, -0.038091708, -0.00089292164, -0.0128731495, -0.0067098704, 0.013071054, 0.004957011, 0.009706695, 0.00526329, -0.018244816, 0.006530815, -0.015238567, 0.0386006, -0.00803865, 0.016623892, -0.002636357, 0.039015256, 0.0073836846, 0.0012274728, 0.012891998, -0.021392424, -0.011393586, -0.012232319, 0.02105316, -0.017509745, -0.0018152932, 0.008340218, -0.014974697, 0.008090482, 0.0010867021, 0.00017625779, -0.011770545, -0.01209096, -0.011883632, 0.007115101, 0.0073648365, -0.035792258, -0.031306446, -0.03909065, -0.00606904, 0.013824971, 0.016557924, -0.004141837, -4.715669e-05, -0.009876326, 0.023296066, 0.0050795227, -0.020374633, -0.0066014943, 0.004054665, 0.009221359, 0.016991427, -0.015191448, 0.017830161, -0.0006060794, -0.00827425, 0.014201931, 0.0034892268, 0.0057203528, 0.019997675, 0.007986818, -0.016736979, -0.015153752, -0.017274147, -0.024295008, -0.010309828, 0.008132891, 0.0028860923, -0.0029120082, 0.019187214, -0.0054470575, -0.019356845, 0.024332704, 0.012656398, -0.011619762, -0.0048015155, -0.002638713, -0.0073082927, -0.0007851349, 0.0075580277, 0.02178823, -0.0051784744, 0.0014041723, 0.016491957, -0.0069219097, 0.0054753297, -0.007190493, -0.013023933, 0.0017622833, -0.004495236, -0.007661692, -0.0016798235, 0.015898246, -0.00912712, 0.04090005, -0.0149652725, 0.009320311, 0.0020685624, 0.05202034, 0.01374958, 0.0023182977, 0.025293948, 0.014852185, -0.021015463, -0.005197322, -0.010554852, 0.004577696, -0.013155869, -0.006822958, 0.0034185469, -0.00680411, 0.009857478, -0.012854302, -0.013165293, 0.017274147, 0.0019849248, 0.0050465385, -0.010988355, 0.02143012, -0.014682553, -0.018386176, -0.011374738, 0.031061422, -0.006050192, 0.022919107, -0.0061067357, -0.011035475, 0.004424556, -0.00033013363, -0.0048439233, 0.011836513, -0.0068983496, -0.01636002, -0.00066026725, -0.031909578, -0.016510803, 0.004292621, -0.010281556, 0.01659562, 0.0039085937, 0.0036989101, -0.011732849, 0.00028963998, 0.011836513, 0.030364048, -0.007647556, -0.016058454, 0.03273889, 0.01747205, -0.0144846495, -0.00043497534, 0.0055648573, -0.024747359, -0.0026952568, 0.0006408303, 0.014380986, -0.030232111, -0.0073365644, 0.0016114997, 0.022636387, 0.016180964, -0.0038190659, 0.004073513, 0.010950659, -0.031306446, -0.008128178, -0.0037012661, -0.013353772, 0.012298288, -0.015662646, 0.00151726, -0.010460612, -0.012703518, 0.01557783, 0.010328677, 0.010140197, 0.00095241045, -0.005729777, 0.017170483, 0.015794583, -0.018763134, 0.008882096, 0.002245262, 0.0054329215, -0.01066794, 0.012467919, -0.022862563, -0.00038167098, 0.017415505, -0.00810933, -0.028630037, -0.0059182565, 0.087303706, 0.0016444837, 0.010620819, 0.009716118, 0.0038803217, 0.007261173, 0.00079750386, 0.0066439025, -0.0016845355, -0.012741215, 0.0021510222, -0.017104514, 0.022655236, -0.009584183, -0.008175299, -0.015521287, 0.017952673, -0.0065025426, -0.0044386922, 0.002610441, -0.00029096522, 0.022598691, -0.016633315, 0.023654178, 0.034699075, 0.009546487, 0.0016162117, 0.022692932, -0.01837675, -0.026029019, -0.0020744526, 0.005409362, 0.005663809, -0.024803903, 0.038581755, -0.008514562, -0.010375797, 0.009358007, -0.0043420964, -0.006822958, 0.008792569, 0.0066156304, -0.00011470744, -0.016539076, -0.015229143, -0.0028884483, 0.007600436, 0.011704577, -0.005211458, 0.0036117383, 0.016416565, 0.02913893, -0.012411375, -0.0057721846, 0.0031593875, 0.0037130462, -0.024125377, 0.023314914, -0.019140093, -0.019677259, 0.013193565, 0.010168469, 0.00822713, 0.0016727556, 0.0021015464, -0.00526329, -0.01621866, 0.028969299, -0.0027376649, 0.0011662169, -0.010620819, 0.007887867, -0.001881261, -0.013721308, 0.013071054, -0.028912755, -0.015558982, -0.0021757602, 0.00889152, 0.009819782, -0.00049652567, 0.015738038, 8.665639e-05, 0.0064412868, -0.012741215, 0.00022912039, -0.0031546757, -0.010328677, 0.021467814, 0.0012698807, -0.001088469, 0.011063746, -0.0012663467, 0.022108646, 0.011911904, -0.01453177, 0.019978827, 0.01994113, -0.0031264038, -0.002235838, -0.03354935, 0.0073554125, -0.0006437753, 0.026651, 0.005692081, -0.018320207, -0.013108749, 0.01894219, 0.0019448728, -0.024200767, 0.01130877, 0.027084503, 0.011553793, -0.039015256, 0.015643798, -0.0055648573, -0.0047143437, -0.0160773, -0.006483695, 0.044895817, -0.025030078, 0.0033148832, 0.026537914, -0.008971624, 0.028912755, -0.0076993876, -0.014710825, -0.013306653, 0.017830161, -0.015973637, -0.009848054, 0.019846892, -0.011195682, 0.00526329, -0.006342335, 0.00306986, 0.0069219097, -0.0072753085, 0.015050088, -0.0024313855, -0.010111925, 0.006087888, -0.027649943]
            
            similarity_array = []
            page_embeddings = {}
            
            # # Load the embeddings as an object with page number as key and its embeddings as an array
            CSV.foreach("book_embeddings.csv", headers: false, col_sep: ",") do |row|
                values = row.to_a
                
                if values[0] != "title"
                    page = values[0]
                    values.shift
                    
                    page_embeddings[page] = values.map do |value| 
                        value.to_f
                    end
                end
            end
            
            page_embeddings.each do |page, embedding|
                similarity_array << [page, cosine_similarity(question_embedding, embedding)]
            end
            
            similarity_array_sorted = similarity_array.sort_by { |page, similarity| similarity }.reverse
            csv = CSV.read('book_page_data.csv', headers: true)
            
            chosen_sections = []
            total_section_length = 0
            
            similarity_array_sorted.each do |page, similarity|
                section = csv.find {|row| row['title'] == page}
                
                if total_section_length + section['tokens'].to_i + SEPARATOR_LENGTH > MAX_TOKENS_LENGTH
                    left_token_count = MAX_TOKENS_LENGTH - total_section_length
                    truncated_content = tokenizer.decode(tokenizer.encode(SEPARATOR + section['content']).ids[0..left_token_count])
                    chosen_sections << truncated_content
                    break
                end
                
                total_section_length += section['tokens'].to_i + SEPARATOR_LENGTH
                chosen_sections << section['content']
            end
            
            header = "Sahil Lavingia is the founder and CEO of Gumroad, and the author of the book The Minimalist Entrepreneur (also known as TME). These are questions and answers by him. Please keep your answers to three sentences maximum, and speak in complete sentences. Stop speaking once your point is made.\n\nContext that may be useful, pulled from The Minimalist Entrepreneur:\n"

            question_1 = "\n\n\nQ: How to choose what business to start?\n\nA: First off don't be in a rush. Look around you, see what problems you or other people are facing, and solve one of these problems if you see some overlap with your passions or skills. Or, even if you don't see an overlap, imagine how you would solve that problem anyway. Start super, super small."
            question_2 = "\n\n\nQ: Q: Should we start the business on the side first or should we put full effort right from the start?\n\nA:   Always on the side. Things start small and get bigger from there, and I don't know if I would ever fully commit to something unless I had some semblance of customer traction. Like with this product I'm working on now!"
            question_3 = "\n\n\nQ: Should we sell first than build or the other way around?\n\nA: I would recommend building first. Building will teach you a lot, and too many people use sales as an excuse to never learn essential skills like building. You can't sell a house you can't build!"
            question_4 = "\n\n\nQ: Andrew Chen has a book on this so maybe touch, but how should founders think about the cold start problem? Businesses are hard to start, and even harder to sustain but the latter is somewhat defined and structured, whereas the former is the vast unknown. Not sure if it's worthy, but this is something I have personally struggled with\n\nA: Hey, this is about my book, not his! I would solve the problem from a single player perspective first. For example, Gumroad is useful to a creator looking to sell something even if no one is currently using the platform. Usage helps, but it's not necessary."
            question_5 = "\n\n\nQ: What is one business that you think is ripe for a minimalist Entrepreneur innovation that isn't currently being pursued by your community?\n\nA: I would move to a place outside of a big city and watch how broken, slow, and non-automated most things are. And of course the big categories like housing, transportation, toys, healthcare, supply chain, food, and more, are constantly being upturned. Go to an industry conference and it's all they talk about! Any industry"
            question_6 = "\n\n\nQ: How can you tell if your pricing is right? If you are leaving money on the table\n\nA: I would work backwards from the kind of success you want, how many customers you think you can reasonably get to within a few years, and then reverse engineer how much it should be priced to make that work."
            question_7 = "\n\n\nQ: Why is the name of your book 'the minimalist entrepreneur' \n\nA: I think more people should start businesses, and was hoping that making it feel more minimal would make it feel more achievable and lead more people to starting-the hardest step."
            question_8 = "\n\n\nQ: How long it takes to write TME\n\nA: About 500 hours over the course of a year or two, including book proposal and outline."
            question_9 = "\n\n\nQ: What is the best way to distribute surveys to test my product idea\n\nA: I use Google Forms and my email list / Twitter account. Works great and is 100% free."
            question_10 = "\n\n\nQ: How do you know, when to quit\n\nA: When I'm bored, no longer learning, not earning enough, getting physically unhealthy, etc loads of reasons. I think the default should be to quit and work on something new. Few things are worth holding your attention for a long period of time."

            context = chosen_sections.join
            prompt = header + context + question_1 + question_2 + question_3 + question_4 + question_5 + question_6 + question_7 + question_8 + question_9 + question_10 + "\n\n\nQ: " + @question.question + "\n\nA: "
            
            puts "===\n" + prompt
            response = openai.completions(
                parameters: {
                    prompt: prompt,
                    temperature: 0.0,
                    max_tokens: 150,
                    model: "text-davinci-003",
                }
            )
            
            puts "===\n" + response.to_s
            answer = response['choices'][0]['text'].lstrip
            puts "===\n" + answer
            @question.answer = answer
            
            if @question.save
                render json: {status: 'SUCCESS', message: 'Saved answer', data: @question, url: '/answer/' + @question.id.to_s}, status: :ok
            else
                render json: {status: 'ERROR', message: 'Answer not saved', data: @question.errors}, status: :unprocessable_entity
            end
        end
    end
    
    def answer
        @book = Book.first
        @answer = Question.find(params[:id])
    end
end
